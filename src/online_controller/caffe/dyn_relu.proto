name: "JointStateRegressionNet"

layer {
    name: "Data"
    type: "HDF5Data"
    top: "data"
    top: "label"
    hdf5_data_param {
        source: "caffe/dyndata_armwave_train.txt"
        batch_size: 50
    }
    include: { phase: TRAIN }
}

layer {
    name: "Data"
    type: "HDF5Data"
    top: "data"
    top: "label"
    hdf5_data_param {
        source: "caffe/dyndata_armwave_train.txt"
        batch_size: 50
    }
    include: {
    phase: TEST
    stage: 'test-on-train'
    }
}

layer {
    name: "Data"
    type: "HDF5Data"
    top: "data"
    top: "label"
    hdf5_data_param {
        source: "caffe/dyndata_armwave_test.txt"
        batch_size: 50
    }
    include: { 
    phase: TEST 
    stage: "test-on-val"
    }
}

layer {
    name: "ip1"
    type: "InnerProduct"
    bottom: "data"
    top: "ip1"
    inner_product_param {
        num_output: 100
        weight_filler {
            type: "xavier"
        }
        bias_filler {
            type: "gaussian"
            std: 0.01
        }
    }
}

layer {
    name: "relu1"
    type: "ReLU"
    bottom: "ip1"
    top: "ip1"
}

layer {
    name: "ip3"
    type: "InnerProduct"
    bottom: "ip1"
    top: "ip3"
    inner_product_param {
        num_output: 50
        weight_filler {
            type: "xavier"
        }
        bias_filler {
            type: "gaussian"
            std: 0.01
        }
    }
}

layer {
    name: "relu3"
    type: "ReLU"
    bottom: "ip3"
    top: "ip3"
}

#layer {
#    name: "drop1"
#    type: "Dropout"
#    bottom: "ip1"
#    top: "drop1"
#    dropout_param{
#        dropout_ratio: 0.5
#    }
#}

layer {
    name: "ip4"
    type: "InnerProduct"
    bottom: "ip3"
    top: "net_out"
    inner_product_param {
        num_output: 32
        weight_filler {
            type: "xavier"
        }
        bias_filler {
            type: "constant"
            value: 0
            #std: 0.01
        }
    }
}

layer {
    name: "loss"
    type: "EuclideanLoss"
    bottom: "net_out"
    bottom: "label"
    top: "euclidean_error"
    loss_weight: 1
    }

layer {
    name: "HDF5Output"
    type: "HDF5Output"
    bottom: "data"
    bottom: "net_out"
    bottom: "label"
    hdf5_output_param {
        file_name: "caffe/output/relu_out.h5"
    }
    include: {
        phase: TEST
        stage: 'test-on-val'
    }
}
